###################### Filebeat Configuration Example #########################

# This file is an example configuration file highlighting only the most common
# options. The filebeat.reference.yml file from the same directory contains all the
# supported options with more comments. You can use it as a reference.
#
# You can find the full configuration reference here:
# https://www.elastic.co/guide/en/beats/filebeat/index.html

# For more available modules and options, please see the filebeat.reference.yml sample
# configuration file.

#=========================== Filebeat inputs =============================

filebeat.inputs:
  - type: log 
    enabled: true
    paths:
      - "/mnt/log/*/logs/*.log"
    ignore_older: 12h
    close.on_state_change.inactive: 2h 


#============================= Filebeat modules ===============================

filebeat.config:
  modules:
    path: ${path.config}/modules.d/*.yml
    reload.enabled: true


#================================ Outputs =====================================

# Configure what output to use when sending the data collected by the beat.
output.elasticsearch:
  hosts: ["${ELASTICSEARCH_HOSTS:localhost:9200}"]
  username: '${ELASTICSEARCH_USERNAME:elastic}'
  password: '${ELASTIC_PASSWORD:PleaseChangeMe}'
  protocol: "http"

setup.kibana:
  host: "${KIBANA_HOSTS}"


#----------------------------- ILM --------------------------------
#
setup.ilm:
    enabled: auto
#    rollover_alias: "quaystone_filebeat-%{[beat.version]}"

#================================ Processors =====================================

# Configure processors to enhance or manipulate events generated by the beat.

processors:
#  - add_host_metadata: ~  
#  - add_docker_metadata: ~  
  - decode_json_fields:
      fields: ['message']
      target: ""
      process_array: true
      max_depth: 8
      overwrite_keys: true
  - add_tags:            
      target: "Environment"
      tags: ['${ASPNETCORE_ENVIRONMENT}']
      
#================================ Logging =====================================

# Sets log level. The default log level is info.
# Available log levels are: error, warning, info, debug
logging.level: debug      
logging.to_files: true
logging.files:
  path: /var/log/filebeat
  name: filebeat
  keepfiles: 7
  permissions: 0666
